<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>VÃ²ng Quay LÃ¬ XÃ¬ 2026</title>
<style>
body {
    text-align: center;
    font-family: Arial, sans-serif;
    background: linear-gradient(red, darkred);
    color: gold;
}

h1 {
    margin-top: 20px;
}

input {
    padding: 10px;
    margin: 5px;
    font-size: 16px;
}

button {
    padding: 12px 25px;
    font-size: 18px;
    background: gold;
    border: none;
    cursor: pointer;
    margin-top: 10px;
}

.wheel-container {
    position: relative;
    width: 320px;
    margin: 30px auto;
}

#wheel {
    width: 320px;
    height: 320px;
    border-radius: 50%;
    border: 8px solid gold;
    transition: transform 4s ease-out;
}

.pointer {
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 40px;
    color: gold;
}

#envelope {
    display: none;
    margin-top: 20px;
    cursor: pointer;
}

#result {
    font-size: 28px;
    margin-top: 15px;
}
</style>
</head>
<body>

<h1>ðŸ§§ VÃ²ng Quay LÃ¬ XÃ¬ 2026 ðŸ§§</h1>

<input id="name" placeholder="Nháº­p tÃªn">
<br>
<input id="account" placeholder="Sá»‘ tÃ i khoáº£n">
<br>
<button onclick="spin()">Quay ngay</button>

<div class="wheel-container">
    <div class="pointer">â–¼</div>
    <canvas id="wheel" width="320" height="320"></canvas>
</div>

<div id="envelope" onclick="openEnvelope()">
    <img src="https://i.imgur.com/6X4K3KX.png" width="140">
    <p>Báº¥m Ä‘á»ƒ má»Ÿ lÃ¬ xÃ¬</p>
</div>

<div id="result"></div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzeUWlV0e6H_ZITOR9N8afJl_TpHkUIWminBb8ciYXZqC7kz5wezjKWoNFYyDS0r70/exec";

const wheelItems = [
    "1.000â‚«",
    "2.000â‚«",
    "5.000â‚«",
    "10.000â‚«",
    "20.000â‚«",
    "50.000â‚«",
    "100.000â‚«",
    "200.000â‚«",
    "400.000â‚«",
    "500.000â‚«"
];

// chá»‰ cÃ¡c giáº£i Ä‘Æ°á»£c phÃ©p trÃºng
let prizes = [
    {name: "1.000â‚«", count: 10},
    {name: "2.000â‚«", count: 10},
    {name: "5.000â‚«", count: 8},
    {name: "10.000â‚«", count: 6},
    {name: "20.000â‚«", count: 5},
    {name: "50.000â‚«", count: 3},
    {name: "100.000â‚«", count: 1}
];

let currentPrize = "";
let currentUser = {};
let angle = 0;

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");

function drawWheel() {
    const size = wheelItems.length;
    const arc = (2 * Math.PI) / size;

    for (let i = 0; i < size; i++) {
        ctx.beginPath();
        ctx.fillStyle = i % 2 === 0 ? "#ffd700" : "#ffcc00";
        ctx.moveTo(160,160);
        ctx.arc(160,160,160,i*arc,(i+1)*arc);
        ctx.fill();

        ctx.save();
        ctx.translate(160,160);
        ctx.rotate(i*arc + arc/2);
        ctx.fillStyle = "red";
        ctx.font = "14px Arial";
        ctx.fillText(wheelItems[i], 60, 5);
        ctx.restore();
    }
}

drawWheel();

function spin() {
    let name = document.getElementById("name").value.trim();
let account = document.getElementById("account").value.trim();

    if (!name || !account) {
        alert("Nháº­p Ä‘á»§ thÃ´ng tin!");
        return;
    }

    let history = JSON.parse(localStorage.getItem("history") || "[]");
    if (history.find(h => h.account === account)) {
        alert("Báº¡n Ä‘Ã£ quay rá»“i!");
        return;
    }

    let available = prizes.filter(p => p.count > 0);
    if (available.length === 0) {
        alert("Háº¿t lÃ¬ xÃ¬!");
        return;
    }

    let random = available[Math.floor(Math.random()*available.length)];
    currentPrize = random.name;
    random.count--;

    currentUser = {name, account};

    let index = wheelItems.indexOf(currentPrize);
    let deg = 360 - (index * (360 / wheelItems.length)) + 1440;

    angle += deg;
    canvas.style.transform = "rotate(" + angle + "deg)";

    setTimeout(()=>{
        document.getElementById("envelope").style.display = "block";
    },4000);
}

function openEnvelope(){
    document.getElementById("result").innerText =
        "Báº¡n nháº­n Ä‘Æ°á»£c: " + currentPrize;

    document.getElementById("envelope").style.display = "none";

    let history = JSON.parse(localStorage.getItem("history") || "[]");
    history.push({
        name: currentUser.name,
        account: currentUser.account,
        prize: currentPrize
    });
    localStorage.setItem("history", JSON.stringify(history));

    fetch(SCRIPT_URL, {
    method: "POST",
    body: JSON.stringify({
        name: currentUser.name,
        account: currentUser.account,
        prize: currentPrize
    }),
    headers: {"Content-Type": "application/json"}
});
}
</script>

</body>
</html>
